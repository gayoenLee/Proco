# PROCO

> SNS서비스로 초대 기반으로 가입해 연결된 사람들끼리 약속을 만들거나 그 외 취향 및 관심사 기반 모임을 가질 수 있는 앱입니다.

&nbsp;

### Index

- [기능](#기능)
- [trouble shooting](#trouble-shooting)
- [학습한 내용](#관련-학습-내용)

---

## 기능

- [친구 추천](#친구-추천)
- [친구와 약속 만들기](#친구와-약속-만들기)
- [채팅](#채팅)
- [달력](#달력)
- [모임 추천과 만들기](#모임-추천과-만들기)
- [모임 참가](#모임-참가)

### 친구 추천

친구탭
- 친구들의 접속 상태, 스케줄 실시간 확인 가능
- 오늘 심심한 친구 = 달력에서 오늘을 심심기간으로 설정한 친구
- 내 스케줄 공개범위 설정

| 친구탭 메인  		      | 친구 그룹화		    | 내 스케줄 공개범위 설정해 만들기     |
| --------------------------- | --------------------------- | ---------------------------- |
|<img width="250" alt="Screenshot 2024-09-04 at 11 13 28 PM" src="https://github.com/user-attachments/assets/ec640a7d-978d-4e03-b569-febe980fa23a"> |<img width="255" alt="Screenshot 2024-09-04 at 11 48 52 PM" src="https://github.com/user-attachments/assets/c9cc8f1e-42e7-407f-988d-1f4e4576d616"> | <img width="250" alt="Screenshot 2024-09-04 at 11 51 05 PM" src="https://github.com/user-attachments/assets/d5b689b9-a092-40d2-ba9f-ea2762314fe8"> |


### 친구와 약속 만들기

친구탭
- 약속 생성 -> 알릴 친구들 설정 -> 약속 세부 정보

| 친구와 약속 만들기 화면  	      | 알릴 친구들 설정		    | 약속 상세 화면	           |
| --------------------------- | --------------------------- | ---------------------------- |
|<img width="250" alt="Screenshot 2024-09-04 at 11 55 24 PM" src="https://github.com/user-attachments/assets/97ab7132-102d-4e5a-ad35-4b237c317d1b"> |<img width="250" alt="Screenshot 2024-09-04 at 11 55 32 PM" src="https://github.com/user-attachments/assets/1af4fbfb-f4c2-477f-b2b6-ab38f60f51e4"> | <img width="250" alt="Screenshot 2024-09-04 at 11 55 40 PM" src="https://github.com/user-attachments/assets/bd7d7aff-aeb1-428d-9397-a3a094501ffc"> |





### 모임 추천, 만들기

모임탭
- 친구외 사용자들의 모임을 취향&온/오프라인&날짜&태그로 필터링해 확인 가능
- 온/오프라인 모임 주최 가능
- 오프라인 모임 - 위치 설정
- 온라인 모임 - 채팅방 생성
  
| 모임 메인  		      | 모임 만들기(채팅만=온라인) 	    | 만나서(오프라인)모임 만들기         |
| --------------------------- | --------------------------- | ---------------------------- |
|<img width="250" alt="Screenshot 2024-09-04 at 11 17 16 PM" src="https://github.com/user-attachments/assets/6f265823-34cc-411c-b79a-281b441b025e"> | <img width="250" alt="Screenshot 2024-09-05 at 12 01 57 AM" src="https://github.com/user-attachments/assets/cd778c7c-00b0-4971-9cc4-eb664280e6c4"> | <img width="250" alt="Screenshot 2024-09-05 at 12 02 09 AM" src="https://github.com/user-attachments/assets/6d1b1f72-a634-449f-8c08-9d7380ca142f"> |


### 모임 참가

모임탭

| 모임 세부 화면  		      | 모임 이용 규칙, 참가 신청 	    |
| --------------------------- | --------------------------- | 
|<img width="250" alt="Screenshot 2024-09-04 at 11 59 02 PM" src="https://github.com/user-attachments/assets/5109e985-4cad-42d7-811d-fc5f29f09649"> | <img width="250" alt="Screenshot 2024-09-04 at 11 59 08 PM" src="https://github.com/user-attachments/assets/3f4cd643-b3f4-49c4-af8a-02a11e27a09a"> |


### 달력
- 심심기간 = 사용자가 이날 시간이 있음을 기간을 선택
- 심심기간으로 선택된 날짜의 상단에는 노란색 상단바로 구별
- 메인에 오늘 심심한 친구 = 심심기간으로 설정된 날짜인 친구 쿼리
  

| 캘린더 메인(참여or예정or개인 약속)  | 심심기간 설정 버튼		    | 일정 정보(심심기간=상단 노란색 구별)| 관심있어요(심심기간), 좋아요(날짜)   |
| --------------------------- | --------------------------- | ---------------------------- |---------------------------- |
|<img width="250" alt="Screenshot 2024-09-05 at 12 10 51 AM" src="https://github.com/user-attachments/assets/ecd1492e-1d14-4906-b75a-f9f0e490b616"> | <img width="250" alt="Screenshot 2024-09-05 at 10 37 24 AM" src="https://github.com/user-attachments/assets/8a47959e-9261-47ec-abfa-fec64a363c6b"> | <img width="250" alt="Screenshot 2024-09-05 at 12 11 02 AM" src="https://github.com/user-attachments/assets/e8f37a13-2461-4290-b9eb-2571d640db5c">| <img width="250" alt="Screenshot 2024-09-05 at 12 11 13 AM" src="https://github.com/user-attachments/assets/c9445cb5-875e-4374-9f2a-242508a1fb37">


### 채팅


| 일반, 친구, 모임 채팅방          | 아직 확인하지 않은 메세지 수 표시   | 텍스트 또는 이미지 전송           |
| --------------------------- | --------------------------- | ---------------------------- |
| <img width="250" alt="Screenshot 2024-09-05 at 12 31 47 AM" src="https://github.com/user-attachments/assets/b7cc9324-ec58-4147-bcbf-20bc7bfd2c32"> | <img width="250" alt="Screenshot 2024-09-05 at 12 31 56 AM" src="https://github.com/user-attachments/assets/f1d55a8b-4fe2-4e0d-bead-bd3ddcbcacf5"> | <img width="250" alt="Screenshot 2024-09-05 at 12 32 04 AM" src="https://github.com/user-attachments/assets/7e8aa216-788d-4835-83a3-12cbf8255771"> |



일반 채팅방 - 카드 초대/ 카드 만들기

|  채팅방 메뉴                   | 카드 초대하기                  | 약속 템플릿 전송                 |
| --------------------------- | --------------------------- | ---------------------------- |
| <img width="250" alt="Screenshot 2024-09-05 at 12 31 47 AM" src="https://github.com/user-attachments/assets/272a99d5-e95c-489b-946a-dec676cb25d0"> | <img width="250" alt="Screenshot 2024-09-05 at 12 31 56 AM" src="https://github.com/user-attachments/assets/2716d44b-a72c-42c9-b47b-dbecad486955"> | <img width="250" alt="Screenshot 2024-09-05 at 12 32 04 AM" src="https://github.com/user-attachments/assets/b8b94f8d-0a32-4a16-b879-d0988e925bd9"> |



메세지 재전송 처리 구현

| 전송 대기 및 전송 실패           | 재전송 및 삭제                 | 메세지 재전송 처리                |
| --------------------------- | --------------------------- | ---------------------------- |
| <img width="250" alt="Screenshot 2024-09-05 at 12 20 17 AM" src="https://github.com/user-attachments/assets/93650671-1726-4e28-a897-0deac1bff4a4"> |<img width="250" alt="Screenshot 2024-09-05 at 12 20 25 AM" src="https://github.com/user-attachments/assets/aa382731-4fc0-48b4-b053-d95f5f161bad">| <img width="250" alt="Screenshot 2024-09-05 at 12 22 39 AM" src="https://github.com/user-attachments/assets/1fc73bc2-243e-4e2b-990e-8af2ea4ebae3"> |



채팅방 메뉴 및 설정

| 친구                          | 모임 - 사용자 신고,추방,나가기,알림|
| --------------------------- | --------------------------- |
| <img width="250" alt="Screenshot 2024-09-05 at 12 28 43 AM" src="https://github.com/user-attachments/assets/40d66c3a-bd78-435c-8b70-45acdc54f425"> | <img width="500" alt="Screenshot 2024-09-05 at 12 28 56 AM" src="https://github.com/user-attachments/assets/2060c0ac-f10f-4d20-a397-ff66fff6905d"> |




&nbsp;


---

## Trouble Shooting

### iOS 디자인 시스템 설계하기
- Swift와는 다른 시스템을 가진 SwiftUI프레임워크로 프로젝트를 개발을 하게 됐습니다.
- 앱의 추후 확장성과 유지 보수등을 고려한 앱 디자인 설계가 필요했습니다.
- 동료 팀원들과 협업
    
    ⇒ 해결
    MVVM패턴을 도입했습니다.
    
    ⇒ 성과
    SwiftUI에서 뷰 전환시 onAppear, onDisappear에서 데이터를 가져오는 통신이 무거운 작업이어서 비동기로 처리가 되지 않았습니다. 또한 앱 전환시의 분기 처리를 하는 작업이 너무 번거로웠습니다.
    
    [MVVM 도입기](https://www.notion.so/MVVM-0932242d833c426d979cdcafbc91d45f?pvs=21)


### 백그라운드에서 채팅 메세지 푸시하기

- 문제 상황 : 채팅 메세지를 안드로이드처럼 백그라운드 서비스를 사용하려 했지만 iOS에서는 불가했습니다.
    
    ⇒ 해결
     메세지 푸시를 하기 위해 **Firebase의 FCM**을 이용했습니다.
    
    - 안드로이드와 병행 개발을 위해 FCM을 사용했습니다.
        
        [iOS - 백그라운드에서 메세지 푸시 구현](https://www.notion.so/iOS-0f5ef3637273484da39e63d899100783?pvs=21)

&nbsp;

### 로컬에 채팅 메세지 저장하기

- 문제 상황 : 채팅 메세지를 유저의 로컬 디바이스에 저장해 와이파이가 끊기거나 이전 메세지들을 보여주는 경우등의 분기 처리를 해줘야 했습니다.
    
    ⇒ 해결 
        조건에 맞는 로컬 DB들을 비교한 후 SQLite에 채팅 메세지를 저장하는 로직을 작성했습니다.
    
   ⇒ 성과 
    서버에서 이미 기존에 RDBMS로 구성된 로직을 활용해 SQLite의 쿼리문으로 채팅 메세지 저장을 좀 더 빠르게 구현할 수 있었습니다. 
 [로컬DB의 도입과 느낀 점](https://www.notion.so/DB-bcf523493e164148aa8cec82298a1a12?pvs=4)

&nbsp;

### MVVM으로 설계하기
## 배경

- SwiftUI 프레임워크 도입으로 이전 Swift와 달라진 코드 작성 방식?
- 추후 유지 보수를 위한 코드 관리와 확장성 고려
- 같은 파트 팀원들과의 협업

⇒ 해결
MVVM패턴을 도입했습니다.

⇒ 성과
SwiftUI에서 뷰 전환시 onAppear, onDisappear에서 데이터를 가져오는 통신이 무거운 작업이어서 비동기로 처리가 되지 않았습니다. 또한 앱 전환시의 분기 처리를 하는 작업이 너무 번거로웠습니다.

[MVVM 도입기](https://www.notion.so/MVVM-0932242d833c426d979cdcafbc91d45f?pvs=21)

&nbsp;


---

## 관련 학습 내용

### iOS의 포그라운드, 백그라운드 제약사항

포그라운드에서 메모리와 기타 시스템 리소스에 높은 우선순위를 가진다. 시스템은 이런 리소스를 사용할 수 있도록 **백그라운드앱을 종료**한다.

 또한 UIKit은 백그라운드가 되면 추가적인 실행 시간을 할당받지 않는다.

백그라운드에서는 가능한 적은 메모리 공간을 사용해야 한다.(시스템 리소스 해제, 메모리에서 해제 후 데이터를 디스크에 작성.)

마지막으로 백그라운드에서는 사용자 이벤트를 받기 어렵고 공유 시스템 리소스를 해제하고 이미지 객체 참조 등 메모리에 제한이 있다.

그런데 UIKit은 몇가지 기능을 가지는 앱에는 추가 실행 시간을 부여한다.

1. AUDIO, PIP VIDEO를 사용하는 경우
2. 블루투스를 이용한 악세사리를 사용하는 경우
3. 위치 서비스를 사용하는 경우
4. 외부 악세사리와 통신하는 경우
5. 앱 업데이트를 진행하는 경우
6. APNS 푸시 알림의 경우
   
&nbsp;

### APP States
ios 12 이전과 이후에 달라짐.

이전

- not running, inactive, active, background, suspended로 이뤄져 있음.

- not running은 앱이 아예 실행되지 않았거나 시스템에 의해 종료되었을 때.

- inactive는 앱이 포그라운드에 있지만 이벤트를 수신하지 않는 상태.

- active는 앱이 포그라운드에 있고 이벤트를 수신하고 있는 상태.

- background는 앱이 백그라운드에 있고 **코드를 실행하고 있는 상태**

- suspended는 앱이 백그라운드에 있고 **메모리에 남아있긴 하지만** 코드를 실행하고 있지 않은 상태

- 시작시 앱의 자료구조와 UI를 초기화.
- Active상태가 되면 UI구성을 완료, 사용자와 상호작용할 준비.
- DeActivation이 되면 데이터를 저장하고 앱 동작 최소화.
- Background가 되면 중요한 작업을 완료, 메모리를 최대한 확보한 뒤 앱 스냅샷 준비.
- 앱 종료되면 작업 즉시 중지, 공유 자원 해제.


ios12이전

**UIKIT가** delegate객체 메서드를 호출

→앱의 상태 변화에 따른 대응을 할 수 있도록 도와주는 역할.

ios13이후

UISceneDelegate가 처리.

사용자나 시스템이 앱의 Scene을 요청하면 UIKit가 이를 생성하고 **Unattached상태로 둔다.**

